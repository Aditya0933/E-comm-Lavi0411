<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="cart.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
    <link rel="icon" href="./Image/e-commerce-logo.png" type="image/png">
    <title>Cart</title>
</head>

<body>
    <!-- container start -->
    <div class="Container">
        <nav class="navbar navbar-expand-lg navbar-light bg-#8A7AB9 fixed-top"
            style="background-color: #8A7AB9; border-bottom: transparent;" id="navbar">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    <p>LOGO</p>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" href="index.html">HOME</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="shop.html">SHOP</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./cart.html">CART <i class="fa-solid fa-cart-shopping"></i> <span
                                    class="cart-count" id="cart-count">0</span></a>
                        </li>
                    </ul>
                    <form class="d-flex">
                        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                        <button id="btn_hover" class="btn btn-outline-success" type="submit">Search</button>
                    </form>
                </div>
            </div>
        </nav>

        <div id="cart-container" class="cart-container">
            <h2 id="heading_cart">Your Cart</h2>
            <div id="cart-items"></div>
            <p id="total-price" class="total-price">Total Price: $0.00</p>
            <button id="clear-cart" class="clear-all-button">Clear All Items</button>
            <button id="checkout" class="checkout-button">Proceed to Checkout</button>
        </div>

        <!-- Success Message -->
        <div id="successMessage" class="d-none text-center">
            <i class="fas fa-check-circle fa-5x" style="color: green;"></i>
            <p>Your order has been placed successfully!</p>
        </div>

        <!-- footer section -->
        <footer class="text-center text-lg-start text-white" style="background-color: #8A7AB9;">
            <div class="container p-4 pb-0">
                <section>
                    <div class="row">
                        <div class="col-md-3 col-lg-3 col-xl-3 mx-auto mt-3">
                            <img src="./Image/f5e884102732761.5f3d3d9493dd6-removebg-preview.png" alt="Logo"
                                style="width: 100px; height: 70; margin-bottom: 6px;">
                            <h6 class="text-uppercase mb-4 font-weight-bold">SKIPLINE</h6>
                            <p>Here you can use rows and columns to organize your footer content. Lorem ipsum dolor sit
                                amet, consectetur adipisicing elit.</p>
                        </div>

                        <div id="text-hover" class="col-md-2 col-lg-2 col-xl-2 mx-auto mt-3">
                            <h6 class="text-uppercase mb-4 font-weight-bold fs-5 ">CUSTOMER SERVICE</h6>
                            <p id="text_Hover"><a class="text-white">REFUND POLICY</a></p>
                            <p id="text_Hover"><a class="text-white">ABOUT</a></p>
                            <p id="text_Hover"><a class="text-white">MY ACCOUNT</a></p>
                            <p id="text_Hover"><a class="text-white">CONTACT US</a></p>
                        </div>

                        <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mt-3">
                            <h6 class="text-uppercase mb-4 font-weight-bold fs-5">Contact</h6>
                            <p><i class="fas fa-home mr-3"></i> New York, NY 10012, US</p>
                            <p><i class="fas fa-envelope mr-3"></i> info@gmail.com</p>
                            <p><i class="fas fa-phone mr-3"></i> + 01 234 567 88</p>
                            <p><i class="fas fa-print mr-3"></i> + 01 234 567 89</p>
                        </div>

                        <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mt-3">
                            <h6 class="text-uppercase mb-4 font-weight-bold fs-5">Follow us</h6>
                            <a class="btn btn-primary btn-floating m-1 social-icon" style="background-color: #3b5998"
                                href="#!"><i class="fab fa-facebook-f"></i></a>
                            <a class="btn btn-primary btn-floating m-1 social-icon" style="background-color: #55acee"
                                href="#!"><i class="fab fa-twitter"></i></a>
                            <a class="btn btn-primary btn-floating m-1 social-icon" style="background-color: #dd4b39"
                                href="#!"><i class="fab fa-google"></i></a>
                            <a class="btn btn-primary btn-floating m-1 social-icon" style="background-color: #ac2bac"
                                href="#!"><i class="fab fa-instagram"></i></a>
                            <a class="btn btn-primary btn-floating m-1 social-icon" style="background-color: #0082ca"
                                href="#!"><i class="fab fa-linkedin-in"></i></a>
                            <a class="btn btn-primary btn-floating m-1 social-icon" style="background-color: #333333"
                                href="#!"><i class="fab fa-github"></i></a>
                        </div>
                    </div>
                </section>
            </div>

            <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2)">
                Â© 2020 Copyright: <a class="text-white" href="./index.html">SKIPLINE.com</a>
            </div>
        </footer>
    </div>

    <!-- Checkout Modal -->
    <div class="modal" id="checkoutModal" tabindex="-1" aria-labelledby="checkoutModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="checkoutModalLabel">Checkout</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="checkoutForm">
                        <div class="mb-3">
                            <label for="name" class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="name" required>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="phone" class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="phone" required>
                        </div>
                        <div class="mb-3">
                            <label for="address" class="form-label">Address</label>
                            <textarea class="form-control" id="address" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="city" class="form-label">City</label>
                            <input type="text" class="form-control" id="city" required>
                        </div>
                        <div class="mb-3">
                            <label for="postal" class="form-label">Postal Code</label>
                            <input type="text" class="form-control" id="postal" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            displayCartItems();
            updateCartCount();
            document.getElementById('clear-cart').onclick = clearCart; // Clear cart button functionality
            document.getElementById('checkout').onclick = proceedToCheckout; // Checkout button functionality
        });

        // Function to display cart items
        function displayCartItems() {
            const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
            const cartContainer = document.getElementById('cart-items');
            cartContainer.innerHTML = ''; // Clear the container

            if (cartItems.length === 0) {
                cartContainer.innerHTML = '<p>Your cart is empty.</p>';
                document.getElementById('total-price').textContent = 'Total Price: $0.00';
                return;
            }

            let totalPrice = 0;

            // Use a map to display unique items
            const uniqueItems = {};
            cartItems.forEach(item => {
                console.log('Start From Here .....');
                console.log('item....quantity After:');
                console.log(item.quantity);
                if (!uniqueItems[item.id]) {
                    uniqueItems[item.id] = item; // Store unique items
                } else {
                    console.log('item.quantity before:');
                    console.log(item.quantity);
                    uniqueItems[item.id].quantity = item.quantity; // Sum quantities for duplicates
                    console.log('item.quantity After:');
                    console.log(item.quantity);
                }
            });

            Object.values(uniqueItems).forEach(item => {
                console.log('item');
                console.log(item);
                const cartItemDiv = document.createElement('div');
                cartItemDiv.classList.add('cart-item');

                // Create image element
                const itemImage = document.createElement('img');
                itemImage.src = item.img;
                itemImage.alt = item.title;
                itemImage.style.cursor = 'pointer'; // Change cursor to pointer
                itemImage.onclick = () => {
                    // Redirect to product details page on click
                    window.location.href = `./productDetails.html?id=${item.id}&title=${encodeURIComponent(item.title)}&price=${item.price}&image=${encodeURIComponent(item.img)}&description=${encodeURIComponent(item.description)}`;
                };

                // Create title, price, and quantity elements
                const cartDetailsDiv = document.createElement('div');
                cartDetailsDiv.classList.add('cart-details');

                const title = document.createElement('p');
                title.textContent = item.title;

                const price = document.createElement('p');
                price.textContent = `Price: $${item.price.toFixed(2)}`;

                const quantity = document.createElement('p');
                quantity.textContent = `Quantity: ${item.quantity}`;

                cartDetailsDiv.append(title, price, quantity);

                // Create remove button with trash icon
                const removeButton = document.createElement('button');
                removeButton.classList.add('remove-button');
                removeButton.innerHTML = '<i class="fas fa-trash-alt"></i>'; // Font Awesome trash icon
                removeButton.onclick = () => {
                    removeFromCart(item.id);
                };

                // Append elements to cart item div
                cartItemDiv.append(itemImage, cartDetailsDiv, removeButton);
                document.getElementById('cart-items').appendChild(cartItemDiv);

                totalPrice += item.price * item.quantity; // Calculate total price
            });

            // Update total price display
            document.getElementById('total-price').textContent = `Total Price: $${totalPrice.toFixed(2)}`;
        }

        // Function to remove item from cart
        function removeFromCart(id) {
            const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
            const updatedCartItems = cartItems.filter(item => item.id !== id);
            localStorage.setItem('cartItems', JSON.stringify(updatedCartItems));
            displayCartItems();
            updateCartCount();
        }

        // Function to clear the cart
        function clearCart() {
            localStorage.removeItem('cartItems');
            displayCartItems();
            updateCartCount();
        }

        // Function to update cart count
        function updateCartCount() {
            const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
            document.getElementById('cart-count').textContent = cartItems.length;
        }

        // Function to handle checkout
        function proceedToCheckout() {
            const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
            if (cartItems.length === 0) {
                alert("Your cart is empty!");
            } else {
                // Show the checkout modal
                const modal = new bootstrap.Modal(document.getElementById('checkoutModal'));
                modal.show();
            }
        }

        // Handle the checkout form submission
        document.getElementById('checkoutForm').onsubmit = function (event) {
            event.preventDefault(); // Prevent default form submission

            // Hide the modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('checkoutModal'));
            modal.hide();

            // Show success message
            const successMessage = document.getElementById('successMessage');
            successMessage.classList.remove('d-none');

            // Optionally, clear the cart
            localStorage.removeItem('cartItems');
            updateCartCount();
            displayCartItems();
        };
    </script>
    <script>
        // Function to update the cart count
        function updateCartCount() {
            const cartUpperValue = document.getElementById("cart-count");
            console.log("Before " + cartUpperValue.textContent);
            const cartAllItems = JSON.parse(localStorage.getItem('cartItems')) || [];
            console.log(cartAllItems);
            console.log(cartAllItems.length);
            cartUpperValue.textContent = cartAllItems.length;
        }
        updateCartCount();
    </script>
</body>

</html>